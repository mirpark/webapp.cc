<!DOCTYPE html> 
<html> 
	<head> 
	<title>Dynamic Listview - JQM</title>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.css" />
	<link rel="stylesheet" href="facebook.css" />
	<!-- JQM -->
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.js"></script>
	<script type="text/javascript" src="http://ragingwind.github.com/js/jquery/jquery.url.js"></script>
	<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
	<script type="text/javascript" src="jquery.mobile.router.js" charset="utf-8"></script>
	<script type="text/javascript" src="jquery.tmpl.get.js" charset="utf-8"></script>
	
	<!-- Local -->
	<script type="text/javascript" charset="utf-8">
		$("#viewport").live("pagebeforecreate", function(e) {
			$.getTmpl("tmpl/sidebar.tmpl", "#sidebar", {id:"#sidebarTemplate", args:"sidebarArgs", remove:true});
			$.getTmpl("tmpl/newsfeed.tmpl", "#stories", {id:"#newsfeedTemplate", args:"newsfeedArgs", remove:true});
		});
	
		function resizePage() {
			$("#page").width($(window).width() - 260);
		}
		
		$( 'div' ).live( 'pageshow',function(event, ui){
		  // console.log( 'This page was just hidden:', ui.prevPage, ui.nextPage, ui);
		});
		
		$( '#viewport' ).live( 'updatelayout',function(event, data){
			console.log("update layout");
			// resizePage();
			// window.deh = document.documentElement.offsetHeight;
		});
		
		$( window ).bind( "orientationchange", function( event ) {
			// resizePage();
			// window.deh = document.documentElement.offsetHeight;
		});
		
		var routes = {
			before:function(r) {
				console.log("routes.before");
			},
			after:function(r) {
				var p = r.url.param();
				console.log("routes.after", p);
				if (p.soft && p.soft == "sidearea")
					routes.toogleSidearea();
			},
			toogleSidearea:function() {
				$("#sidearea").toggle();
				var page = $("#page");
				if (page.offset().left === 0) {
					$("#viewport").css("overflow", "hidden");
					page.offset({left:260})
						.height("1441px")
						.css("min-height", "")
						// .width("300px");
						.css("overflow", "hidden")
					$("#root").css("overflow", "hidden")
					$("#viewport").css("overflow", "hidden");
				}
				else { 
					page.css("min-height", "1441px")
						.css("height", "")
						.css("left", "")
						.css("overflow-y", "visible")
					$("#viewport").css("overflow-x", "visible");
				}
				
			},
			newsfeed:function(r) {
				console.log("newsfeed", r)
			}
		}
		
		$.router(routes);
		
	$(window).ready(function() {
		// $("#navigation").css("min-height", "");
		$("#navigation").css("height", "1441px");
		
		console.log("w", $(window).height(), "d", $(document).height());
		// $("#page").width($(window).width());
		// $(document).height($(window).height());
		// $("#page").css("'min-height", "1441px");
		
		console.log("ddoh", document.documentElement.offsetHeight);
		
		// $.mobile.listview.prototype.options.headerTheme = "facebook";
		
		
	})
	
	</script>
	</head>
	<body>
		<div id="viewport" data-theme="c" style="height:1441px;min-height:100%;">
			<!-- Sidearea start -->
			<div id="sidearea" data-role="conents" style="display:none">
				<ul id="sidebar" data-role="listview">
					<li id='sidebar-header'>
						<input type="search" name="search" id="search" value="" placeholder="Search" />
					</li>
				</ul>
			</div>
			<!-- Sidearea end -->
			
			<!-- Page start -->
			<div id="page" data-role="page" data-theme="c" style='min-height:1441px;'>
				<!-- Header of page start -->
				<div id='header' data-role="header" data-theme="c">
					<!-- Titlebar on top -->
					<div class="ui-grid-b">
						<div class="ui-block-a">
							<a href="#?soft=sidearea" id="toggle" data-role="content"><i class="img touched_hide toggle" style=";"></i></a>
						</div>
						<div class="ui-block-b">
							<a href="#"><i class="img touched_hide unlit find-request"></i></a>
							<a href="#"><i class="img touched_hide unlit messages"></i></a>
							<a href="#"><i class="img touched_hide unlit notifications"></i></a>
						</div>
						<div class="ui-block-c"></div>
					</div>
					<!-- Composer buttons on top  -->					
					<div id='composer' class="ui-grid-b">
						<div class="ui-block-a"><a href="#" data-role="button"><i class="img photo"></i> Photo</a></div>
						<div class="ui-block-b"><a href="#" data-role="button"><i class="img status"></i> Status</a></div>
						<div class="ui-block-c"><a href="#" data-role="button"><i class="img checkin"></i> Check In</a></div>
					</div>
				</div>
				<!-- Header of page end -->
				
				<!-- Content start -->
				<div id="root">
					<!-- Stories -->
					<div id="newsfeed-stream">
						<ul id='stories' data-role="listview">
						</ul>
					</div>
				</div>
				<!-- Content end -->
		</div>
		<!-- Page end -->
	</body>
</html>



<!-- Templates for facebook -->

<!-- Templates for facebook -->
<!-- <script id="sidebarTmpl" type="text/x-jquery-tmpl">
	{{if href}}
	<li data-icon="false"><a href="#${href}"><img src="${icon}">${label}</a></li>
	{{else}}
	<li data-role="list-divider">${label}</li>
	{{/if}}
</script> -->

<script type="text/javascript">
	
		
    // $( "#facebookStoryTmpl" ).tmpl(facebook_newsfeeds).appendTo( "#stories" );
	
	// $( "#sidebarTmpl" ).tmpl( sidebars ).appendTo("#sidebar");

</script>